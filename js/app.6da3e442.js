(function(t){function e(e){for(var n,r,a=e[0],l=e[1],h=e[2],c=0,d=[];c<a.length;c++)r=a[c],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,h||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,a=1;a<i.length;a++){var l=i[a];0!==o[l]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=i[0]))}return t}var n={},o={app:0},s=[];function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-polygon-cropper/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var h=0;h<a.length;h++)e(a[h]);var u=l;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var n=i("85ec"),o=i.n(n);o.a},1763:function(t,e,i){(function(n){var o,s,r;i("99af"),i("cb29"),i("4de4"),i("a15b"),i("d81d"),i("a434"),i("a9e3"),i("d3b7"),i("6062"),i("3ca3"),i("ddb0");var a=i("7037");(function(i,n){"object"===a(e)&&"undefined"!==typeof t?n(e):(s=[e],o=n,r="function"===typeof o?o.apply(e,s):o,void 0===r||(t.exports=r))})(0,(function(t){"use strict";var e={name:"PolygonCrop",props:{canvasClass:{type:String,default:""},width:{type:Number,default:0},height:{type:Number,default:0},wrapperClass:{type:String,default:""},pointerClass:{type:String,default:""},imageSource:{type:String,default:""},showCanvas:{type:Boolean,default:!0},showPointer:{type:Boolean,default:!0}},data:function(){return{editing:1,imageObj:null,positionX:"",positionY:"",oldPositionX:"",oldPositionY:"",ctx:null,imageCanvas:null,redoMarks:[],undoMarks:[],currentMarks:[],redoList:[],undoList:[],redoPointer:[],undoPointer:[],currentPointer:[],resultImage:null,imgWidth:0,imgHeight:0}},mounted:function(){this._initialize()},methods:{_initialize:function(){var t=this;this.imageCanvas=this.$refs.canvas,this.ctx=this.imageCanvas.getContext("2d");var e=new Image;e.onload=function(){t.imgWidth=t.width>0?t.width:e.width,t.imgHeight=t.height>0?t.height:e.height,t.ctx.canvas.width=t.imgWidth,t.ctx.canvas.height=t.imgHeight,t.ctx.drawImage(e,0,0,e.width,e.height,0,0,t.imgWidth,t.imgHeight);var i=new Image;i.src=t.imageCanvas.toDataURL(),i.onload=function(){t.imageObj=i}},e.src=this.imageSource},empty:function(){this.redoList=[],this.undoList=[],this.redoPointer=[],this.undoPointer=[],this.currentPointer=[],this.redoMarks=[],this.undoMarks=[],this.currentMarks=[]},reset:function(){this.empty(),this.imageObj=null,this.resultImage=null,this.editing=1,this._initialize()},savePointer:function(t){this.redoPointer=[],this.currentPointer.push(t),this.undoPointer.push(t)},restorePointer:function(t,e,i){if(t.length>0){var n=t.pop();e.push(n),i?(this.oldPositionX=n.positionX,this.oldPositionY=n.positionY,this.currentPointer.pop()):(this.redoPointer.length>0&&(this.oldPositionX=this.redoPointer[this.redoPointer.length-1]["positionX"],this.oldPositionY=this.redoPointer[this.redoPointer.length-1]["positionY"]),this.currentPointer.push(n))}},restoreMarks:function(t,e,i){var n;if(t.length>1){var o=t.splice(t.length-2,2);e.push.apply(e,o),i?this.currentMarks.splice(t.length-2,2):(n=this.currentMarks).push.apply(n,o)}},saveState:function(t,e,i){i=i||!1,i||(this.redoList=[]),(e||this.undoList).push(t.toDataURL())},restoreState:function(t,e){var i=this;if(t.length){this.saveState(this.imageCanvas,e,!0);var n=t.pop(),o=new Image;o.src=n,o.onload=function(){i.ctx.clearRect(0,0,i.imgWidth,i.imgHeight),i.ctx.drawImage(o,0,0)}}},undo:function(){this.editing&&(this.editing=0,this.restoreState(this.undoList,this.redoList),this.restorePointer(this.undoPointer,this.redoPointer,!0),this.restoreMarks(this.undoMarks,this.redoMarks,!0),this.editing=1)},redo:function(){this.editing&&(this.editing=0,this.restoreState(this.redoList,this.undoList),this.restorePointer(this.redoPointer,this.undoPointer,!1),this.restoreMarks(this.redoMarks,this.undoMarks,!1),this.editing=1)},crop:function(){var t=this;if(this.editing){this.currentPointer=[],this.ctx.clearRect(0,0,this.imgWidth,this.imgHeight),this.ctx.beginPath(),this.ctx.globalCompositeOperation="destination-over";for(var e=this.imageCanvas.offsetLeft,i=this.imageCanvas.offsetTop,n=0;n<this.currentMarks.length;n+=2){var o=this.currentMarks[n],s=this.currentMarks[n+1];0===n?this.ctx.moveTo(o-e,s-i):this.ctx.lineTo(o-e,s-i)}this.ctx.fillStyle=this.ctx.createPattern(this.imageObj,"repeat"),this.ctx.fill();var r=this.trimEmptyPixel(this.imageCanvas,this.ctx),a=r.toDataURL("image/png");this.resultImage=a,this.editing=0;var l=new Image;l.onload=function(){t.ctx.canvas.width=l.width,t.ctx.canvas.height=l.height,t.ctx.drawImage(l,0,0)},l.src=a,this.empty()}},mouseDown:function(t){1===this.editing&&(1===t.which&&(""!==this.oldPositionX&&this.undoList.length>0&&(this.ctx.beginPath(),this.ctx.moveTo(this.oldPositionX,this.oldPositionY),this.ctx.lineTo(this.positionX,this.positionY),this.ctx.strokeStyle="#F63E02",this.ctx.lineWidth=2,this.ctx.setLineDash([1,1]),this.ctx.stroke()),this.redoMarks=[],this.currentMarks.push(t.pageX,t.pageY),this.undoMarks.push(t.pageX,t.pageY),this.saveState(this.imageCanvas),this.savePointer({x:t.pageX+"px",y:t.pageY+"px",positionX:t.offsetX,positionY:t.offsetY}),this.oldPositionX=t.offsetX,this.oldPositionY=t.offsetY),this.positionX=t.offsetX,this.positionY=t.offsetY)},mouseMove:function(t){1===this.editing&&(this.positionX=t.offsetX,this.positionY=t.offsetY)},trimEmptyPixel:function(t,e){var i,n,o,s=document.createElement("canvas").getContext("2d"),r=e.getImageData(0,0,t.width,t.height),a=r.data.length,l={top:null,left:null,right:null,bottom:null};for(i=0;i<a;i+=4)0!==r.data[i+3]&&(n=i/4%t.width,o=~~(i/4/t.width),null===l.top&&(l.top=o),(null===l.left||n<l.left)&&(l.left=n),(null===l.right||l.right<n)&&(l.right=n),(null===l.bottom||l.bottom<o)&&(l.bottom=o));var h=l.bottom-l.top,u=l.right-l.left,c=e.getImageData(l.left,l.top,u,h);return s.canvas.width=u,s.canvas.height=h,s.putImageData(c,0,0),s.canvas}},watch:{imageSource:function(t){this.empty(),this._initialize()}}};function i(t,e,i,n,o,s,r,a,l,h){"boolean"!==typeof r&&(l=a,a=r,r=!1);var u,c="function"===typeof i?i.options:i;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),n&&(c._scopeId=n),s?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=u):e&&(u=r?function(){e.call(this,h(this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),u)if(c.functional){var d=c.render;c.render=function(t,e){return u.call(e),d(t,e)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,u):[u]}return i}var o=i,s="undefined"!==typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function r(t){return function(t,e){return h(t,e)}}var a=document.head||document.getElementsByTagName("head")[0],l={};function h(t,e){var i=s?e.media||"default":t,n=l[i]||(l[i]={ids:new Set,styles:[]});if(!n.ids.has(t)){n.ids.add(t);var o=e.source;if(e.map&&(o+="\n/*# sourceURL="+e.map.sources[0]+" */",o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",e.media&&n.element.setAttribute("media",e.media),a.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(o),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{var r=n.ids.size-1,h=document.createTextNode(o),u=n.element.childNodes;u[r]&&n.element.removeChild(u[r]),u.length?n.element.insertBefore(h,u[r]):n.element.appendChild(h)}}}var u=r,c=e,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.wrapperClass},[i("canvas",{directives:[{name:"show",rawName:"v-show",value:t.showCanvas,expression:"showCanvas"}],ref:"canvas",class:t.canvasClass,on:{mousedown:t.mouseDown,mousemove:t.mouseMove}}),t._v(" "),t._l(t.currentPointer,(function(e){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.showPointer,expression:"showPointer"}],class:"vue-crop-pointer "+t.pointerClass,style:{top:e.y,left:e.x}})}))],2)},p=[],f=function(t){t&&t("data-v-642f2e8f_0",{source:".vue-crop-pointer{border:solid 1px #000;filter:alpha(opacity=50);opacity:.5;position:absolute;width:5px;height:5px}canvas{position:relative;margin-left:0;margin-top:0;cursor:crosshair}",map:void 0,media:void 0})},g=void 0,m=void 0,v=!1,w=o({render:d,staticRenderFns:p},f,c,g,v,m,u,void 0);function b(t){b.installed||(b.installed=!0,t.component("PolygonCrop",w))}var y={install:b},P=null;"undefined"!==typeof window?P=window.Vue:"undefined"!==typeof n&&(P=n.vue),P&&P.use(y),w.install=b,t.default=w,Object.defineProperty(t,"__esModule",{value:!0})}))}).call(this,i("c8ba"))},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("h1",{staticClass:"mb-4 mt-2 alert-success"},[t._v("Vue Image Cropper")]),i("div",[i("b-img",{directives:[{name:"show",rawName:"v-show",value:t.showResult,expression:"showResult"}],attrs:{src:t.resultImage,alt:"Responsive image",fluid:""}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showResult,expression:"showResult"}]},[i("b-link",{attrs:{download:"result.png",href:t.resultImage}},[t._v("Download Image")])],1)],1),i("div",[i("polygonCrop",{ref:"canvas",attrs:{canvasClass:"some-class",height:600,imageSource:t.imgSrc,showCanvas:t.show,showPointer:t.showPointer,width:800}})],1),i("b-row",[i("b-col",[i("b-form-group",[i("b-form-file",{staticClass:"col-sm-6 mt-2",attrs:{state:Boolean(t.file),accept:"image/*","drop-placeholder":"Drop file here...",placeholder:"Choose a file or drop it here...",size:"lg"},on:{change:t.setImage},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),i("div",{staticClass:"mt-3"},[t._v("Selected file: "+t._s(t.file?t.file.name:""))])],1),i("b-button",{attrs:{variant:"success"},on:{click:function(e){return e.preventDefault(),t.crop(e)}}},[t._v("Crop")]),i("b-button",{attrs:{variant:"warning"},on:{click:function(e){return e.preventDefault(),t.undo(e)}}},[t._v("Undo")]),i("b-button",{attrs:{variant:"primary"},on:{click:function(e){return e.preventDefault(),t.redo(e)}}},[t._v("Redo")]),i("b-button",{attrs:{variant:"danger"},on:{click:function(e){return e.preventDefault(),t.reset(e)}}},[t._v("Reset")])],1)],1)],1)},s=[],r=(i("c975"),i("1763")),a=i.n(r),l={name:"App",data:function(){return{imgSrc:"/demo.png",file:null,show:!1,showResult:!1,showPointer:!0,resultImage:""}},components:{polygonCrop:a.a},methods:{setImage:function(t){var e=this,i=t.target.files[0];if(i||-1!==i.type.indexOf("image/"))if("function"===typeof FileReader){var n=new FileReader;n.onload=function(t){e.imgSrc=t.target.result,e.show=!0},n.readAsDataURL(i)}else alert("Sorry, FileReader API not supported");else alert("Please select an image file")},crop:function(){this.$refs.canvas.crop(),this.resultImage=this.$refs.canvas.resultImage,this.show=!1,this.showResult=!0},undo:function(){this.$refs.canvas.undo()},redo:function(){this.$refs.canvas.redo()},reset:function(){this.show=!0,this.showResult=!1,this.$refs.canvas.reset()}}},h=l,u=(i("034f"),i("2877")),c=Object(u["a"])(h,o,s,!1,null,null,null),d=c.exports,p=i("5f5b"),f=i("b1e0");i("f9e3"),i("2dd8");n["default"].config.productionTip=!1,n["default"].use(p["a"]),n["default"].use(f["a"]),new n["default"]({render:function(t){return t(d)}}).$mount("#app")},"85ec":function(t,e,i){}});
//# sourceMappingURL=app.6da3e442.js.map